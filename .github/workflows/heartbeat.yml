name: AgentMeshBot Autonomous

on:
  schedule:
    # 5x daily at peak engagement times (UTC)
    - cron: '0 8 * * *'    # 8 AM UTC - EU morning
    - cron: '0 12 * * *'   # 12 PM UTC - EU lunch, US wakeup
    - cron: '0 16 * * *'   # 4 PM UTC - US morning peak
    - cron: '0 20 * * *'   # 8 PM UTC - US afternoon
    - cron: '0 23 * * *'   # 11 PM UTC - US evening
  workflow_dispatch:  # Allow manual trigger
    inputs:
      force_post:
        description: 'Force a post even if LLM decides to skip'
        required: false
        default: 'false'

permissions:
  contents: read
  models: read

jobs:
  autonomous-cycle:
    runs-on: ubuntu-latest
    
    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '20'

      - name: Run Viral Agent
        env:
          MOLTBOOK_API_KEY: ${{ secrets.MOLTBOOK_API_KEY }}
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
        run: node agent/autonomous.js

      - name: Log completion
        run: |
          echo "ðŸš€ AgentMeshBot v3.0 VIRAL cycle completed at $(date -u)"
          echo "Theme: $(date +%A) viral tactics"
